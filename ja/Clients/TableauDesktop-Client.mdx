---
title: "Tableau Desktop"
description: "このページでは、Tableau Desktop をConnect AI に接続する手順の概要を示します。"
---



## Prerequisites

Connect AI でTableau Desktop を設定して使用する前に、データソースをConnect AI アカウントに接続する必要があります。詳細は、[Sources](/ja/Sources) を参照してください。

このコネクションを確立するには2つの方法があり、それぞれにメリットとデメリットがあります。

- **Tableau Desktop コネクタを使用**：この方法は、レポートに最高のパフォーマンスを提供します。ただし、この方法を使って作成したレポートはパブリッシュできないため、ローカル環境での利用に限定されます。レポートをパブリッシュする必要がない場合に限り、この方法をお勧めします。
- **仮想SQL Server API を使用**：この方法では、ローカル環境の外部にレポートをパブリッシュできます。ただし、この方法を使った場合のパフォーマンスは、コネクタと同じ基準を満たさない場合があります。レポートをパブリッシュする必要がある場合のみ、この方法をお勧めします。

選択した接続方法について、以下の手順に従ってください。

## 方法1：コネクタを使用

Tableau Desktop Connector for Connect AI はTableau のデスクトップ版およびサーバー版の両方でコネクションの確立に使用できます。コネクタは包括的な高性能データアクセス、リアルタイム連携、高度なメタデータ検出、および強固なSQL-92 サポートを搭載しています。

### 手順1：コネクタをインストールする

利用環境に応じて以下の手順に従ってください。

#### Tableau Desktop

**前提条件**

開始する前にサポートされているTableau アプリケーションをインストールする必要があります。サポートされているアプリケーションは以下のとおりです。

- Tableau Desktop 2020.1 以降
- Tableau Prep 2020.4.1 以降

上記より古いバージョンのTableau Desktop の場合は、[ODBC](/ja/Clients/ODBC-Client) もしくは[JDBC](/ja/Clients/JDBC-Client) のいずれかを使用してください。

**インストール方法**

前提条件を満たしていることが確認できたら、次の手順に従ってコネクタをインストールします。

<Steps>
<Step>
Connect AI の**Integrations** ページを開きます。
</Step>
<Step>
**BI and Reporting Tools** セクションで、**Tableau Desktop** をクリックします。
</Step>
<Step>
セットアップファイルをダウンロードして実行します。インストール中にTableau Desktop が起動している場合は、インストール終了後にTableau Desktop を終了し再度起動する必要があります。
</Step>
<Step>
インストールが完了したら、**Finish** をクリックします。
</Step>
</Steps>

Tableau Desktop 2020.3 以降であれば、セットアップファイルが自動的にドライバーをTableau インストールに登録します。デフォルトではドライバー`.jar` ファイルは以下に配置されます。

- Windows: `C:\Program Files\Tableau\Drivers`
- Mac: `/Users/myuser/Library/Tableau/Drivers`

デフォルトではコネクタ`.jar` ファイルは以下に配置されます。

- Windows: `C:\Users\myuser\Documents\My Tableau Repository\Connectors`
- Mac: `/Users/myuser/Documents/My Tableau Repository/Connectors`

**手動登録**

Tableau Prep または2020.3 より前のバージョンのTableau Desktop を使用している場合、Connect AI Connector のセットアップはTableau のインストールを検出することができません。セットアップ完了後に、次の手順に従ってコネクタを手動で登録する必要があります。

<Steps>
<Step>
コネクタのインストール先ディレクトリを見つけます。デフォルトではお使いのプラットフォームに応じて、Windows では`C:\Program Files\CData\Tableau Connector for CData Connect 2021`、MacOS では`/Applications/Tableau Connector for CData Connect 2021` となります。
</Step>
<Step>
Tableau リポジトリを見つけます。リポジトリは通常、ドキュメントフォルダに`My Tableau Repository` という名前で配置されます。Prep を使用している場合は、`My Tableau Prep Repository` という名前になります。
</Step>
<Step>
Tableau のインストール先ディレクトリを開き、`lib` ディレクトリを開きます。`cdata.Cloud.legacy.taco` をTableau リポジトリ内の`Connectors` にコピーします。
</Step>
</Steps>

<Note>
**Note:** Tableau Prep 21.2 以降のバージョンでは、レガシーtaco ファイルの代わりに標準taco ファイルがサポートされます。
</Note>

#### Tableau Server

**前提条件**

開始する前にサポートされているTableau アプリケーションをインストールする必要があります。2020.1 以降のバージョンのTableau Server がサポートされています。

上記より古いバージョンのTableau Server の場合は、[ODBC](/ja/Clients/ODBC-Client) もしくは[JDBC](/ja/Clients/JDBC-Client) のいずれかを使用してください。

<Note>
**Note:** 過去に同じクラスのコネクタの登録がある場合、新しいものは拒否されます。
</Note>

**インストール方法**

前提条件を満たしていることが確認できたら、次の手順に従ってコネクタをインストールします。

<Steps>
<Step>
**Integrations** ページを開きます。
</Step>
<Step>
**BI and Reporting Tools** セクションで、**Tableau Desktop** をクリックします。
</Step>
<Step>
セットアップファイルをダウンロードして実行します。インストール中にTableau Server が起動している場合は、インストール終了後にTableau Server を終了し再度起動する必要があります。
</Step>
<Step>
インストールが完了したら、**Finish** をクリックします。
</Step>
<Step>
デフォルトでは`C:\Program Files\Tableau\Drivers` というパスのDrivers ディレクトリにJAR ファイルが自動的に配置されます。コネクタが正常に機能するためには、このファイルをこの場所に配置しておく必要があります。
</Step>
<Step>
license ファイル（.lic）がJAR と一緒に`Drivers` フォルダに配置されていることを確認します。
</Step>
<Step>
`.taco` ファイルを`[RootDirectory]/data/tabsvc/vizqlserver/Connectors` に配置します。ルートディレクトリは通常、Tableau Server がインストールされているドライブにある`ProgramData` です。
</Step>
<Step>
サーバーを再起動します。
</Step>
<Step>
署名されていないパッケージコネクタを使用するには、オプションでTSM から`native_api.disable_verify_connector_plugin_signature` を`true` に設定し、署名検証を無効にします。
</Step>
</Steps>

### 手順2：Connect AI に接続する

コネクタをインストールしたら、Tableau Desktop またはTableau Server を開き次の手順に従います。
<Steps>
<Step>
サイドバーの**接続**メニューの**サーバーへ**カテゴリの下にある**その他…**をクリックします。
</Step>
<Step>
検索フィールドを使用するか、**CData によるCData Connect** を探してクリックします。
</Step>
<Step>
サインインのプロンプトが表示されます。**サインイン**をクリックします。
</Step>
<Step>
Connect AI アカウントにサインインします。
</Step>
<Step>
サインイン完了後、またはすでにサインインしている場合、左側の**接続**ペインにコネクションが表示されます。
</Step>
</Steps>
Tableau でコネクションを使用するスキーマを選択できるようになりました。

## 方法2：仮想SQL Server を使用

コネクタをダウンロードしてインストールする代わりに、Connect AI 仮想SQL Server API に接続できます。レポートをパブリッシュする必要がある場合のみ、この方法をお勧めします。

### 前提条件

Tableau に接続する前に、Microsoft ODBC Driver for SQL Server の最新版がシステムにインストールされていることを確認してください。最新版であることを確認するには、**ODBC データ ソース アドミニストレーター** > **ドライバー**タブを開きます。

<Frame>
  <img src="/ja/images/tableau_desktop_prereq.png" alt="Tableau Desktop prerequisite" />
</Frame>

使用しているドライバーがSQL Server またはSQL Server Native Client の場合は、Microsoft ODBC Driver 18 for SQL Server にアップグレードしてください。[ここ](https://learn.microsoft.com/ja-jp/sql/connect/odbc/download-odbc-driver-for-sql-server) をクリックしてダウンロードできます。

- Connect AI の[Settings](/ja/Settings#access-tokens) ページでPersonal Access Token（PAT）を生成することも必要です。PAT をコピーし、認証時にパスワードとして使用します。

### Connect AI への接続

Tableau Desktop からConnect AI の仮想SQL Server API へのコネクションを確立するには以下の手順に従います。

<Steps>
<Step>
Tableau Desktop で新しいワークブックを開きます。**サーバーへ**から**その他**を選択し、**Microsoft SQL Server** を選択します。
<Frame>
  <img src="/ja/images/tableau_desktop_sql.png" alt="Tableau Desktop SQL" />
</Frame>
</Step>
<Step>
クレデンシャルを入力します。
	- **Server**—次のように仮想SQL Server のエンドポイントとポートをカンマで区切って入力します。例：*tds.cdata.com*,*14333*
	- **Database**—接続したいConnect AI データソースのConnection Name を入力します。例：*Salesforce1*
	- **Authentication**—**Use a specific username and password** を選択します。
	- **Username**—Connect AI のユーザー名を入力します。ユーザー名は、Connect AI の画面の右上に表示されています。例：*`test@cdata.co.jp`*
	- **Password**—[Settings](/ja/Settings#access-tokens) ページで生成したPAT を入力します。
	- **Require SSL**—選択したままにしておきます。
<Frame>
  <img src="/ja/images/tableau_desktop_login.png" alt="Tableau Desktop login" />
</Frame>
</Step>
<Step>
**サインイン**をクリックします。認証プロセスには数分かかる場合があります。
</Step>
</Steps>

サインインに成功したら、Tableau Desktop サイドバーのデータにアクセスして、レポートを作成およびパブリッシュできます。

## 詳細

Tableau Connector for Connect AI の使用についての詳細は、[こちら](https://cdn.cdata.com/help/LFG/tableau/default.htm)を参照してください。