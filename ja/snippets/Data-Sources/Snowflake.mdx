import SaveAndTest from '/ja/snippets/save-and-test.mdx';

## 前提条件

#### CData IP をホワイトリストに登録

Snowflake への接続を確立するには、CData のIP 経由でSnowflake へのアクセスを許可する必要があります。Snowflake をファイアウォールの内側でホスティングする場合は、これらのIP アドレスをファイアウォールの許可リストに登録する必要があります。

- 範囲：`52.224.0.160`～`52.224.0.175` および`4.154.117.160`～`4.154.117.175`
- CIDR 表記：`52.224.0.160/28` および`4.154.117.160/28`

#### Snowflake が一般にアクセス可能であることを確認

パブリックフェイシングIP / ドメインを指定して、このデータソースに接続します。次のプライベートIP の範囲は機能しません。

- `10.0.0.0` to `10.255.255.255`
- `172.16.0.0` to `172.31.255.255`
- `192.168.0.0` to `192.168.255.255`
- `127.0.0.1` (aka ‘localhost’)

## セットアップガイド

以下の手順で、Snowflake をConnect AI アカウントに接続します。

<Steps>
<Step>
Connect AI のダッシュボードから**Connections** ページを開きます。
</Step>
<Step>
右上の **+ Add Connection** をクリックします。
</Step>
<Step>
検索フィールドに *Snowflake* と入力し、データソース名をクリックします。
</Step>
<Step>
新しいコネクションの**Basic Settings** タブで、コネクション名を入力するかデフォルトの名前をそのまま使用します。
</Step>
<Step>
Enter the Snowflake **Warehouse**.
</Step>
<Step>
Enter the **URL** of the Snowflake database. Snowflake supports URLs in either the account name or connection name format.
	- To use the account name, refer to [Finding the organization and account name for an account](https://docs.snowflake.com/ja/user-guide/admin-account-identifier#label-account-name-find) in the Snowflake documentation.
	- To use the connection name, use the [SHOW CONNECTIONS](https://docs.snowflake.com/ja/sql-reference/sql/show-connections) command.
	The URL format depends on how you are connecting. Refer to the [Connecting with a URL](https://docs.snowflake.com/ja/user-guide/organizations-connect#connecting-with-a-url) in the Snowflake documentation for help in entering the URL correctly.
	The following are a few examples of formatting the URL:
	- Standard URL with account name: `https://<orgname>-<account_name>.snowflakecomputing.com`.
	- Standard URL with connection name: `https://<orgname>-<connectionname>.snowflakecomputing.com`.
	- Okta SSO: `https://<orgname>-<account-name>.snowflakecomputing.com` (if your account name contains an underscore, change the underscore to a hyphen).
</Step>
<Step>
Select the Authentication method, then proceed to the relevant section and follow those instructions.
</Step>
<Step>
Under **Data Credentials**, determine if you want to allow shared credentials or to require users to use their own credentials.
</Step>
</Steps>

## Authentication Methods


<Tabs>
  <Tab title="OAuth">
<Steps>
<Step>
In the **User** field, enter your Snowflake user name.
</Step>
<Step>
The **Callback URL**, or Redirect URL, is the URL you need (`https://oauth.cdata.com/oauth/`) when setting up your OAuth app. Copy this URL and paste it into your OAuth app.
</Step>
<Step>
Enter the **OAuth Client Id** assigned when you registered your Snowflake account.
</Step>
<Step>
Enter the **OAuth Client Secret** for your Snowflake account for OAuth.
</Step>
<Step>
Select the **OAuth Authenticator** that the OAuth application requests from Snowflake. If there is no authenticator, use the default **None**.
</Step>
<Step>
(Optional) Enter the Snowflake **Database** and **Schema**. Selecting a schema may improve performance for some applications.
</Step>
<Step>
OAuth でセキュアに接続するには、**Sign in** をクリックします。これにより、Snowflake のサインインページが新しいタブで開かれます。
</Step>
<Step>
Snowflake アカウントにログインし、リクエストされた権限を設定します（該当する場合）。
</Step>
<SaveAndTest title="Snowflake"/>
</Steps>
  </Tab>

  <Tab title="Password">
<Warning>
**Important:** Any new Snowflake account starting with bundle "2024\_08" will no longer support Password authentication. Please use other authentication methods, such as OAuth or Private Key.
</Warning>

<Steps>
<Step>
Enter your user name in the **User** field and password in the **Password** field.
</Step>
<Step>
In the **Database** section, enter the name of the Snowflake database to connect to.
</Step>
<Step>
(Optional) Enter the schemas of the Snowflake database to connect to. If this is left blank, the connector has access to all schemas in the database.
</Step>
<SaveAndTest title="Snowflake"/>
<Step>
Snowflake で、Connect AI 静的IP アドレスを接続のホワイトリストに追加します。
</Step>
</Steps>
  </Tab>

  <Tab title="Private Key">
Follow these steps to configure private key authentication:

<Steps>
<Step>
Open your Snowflake keyfile (which ends in .p8) in a text editor.
</Step>
<Step>
Copy the entire contents of the file.
</Step>
<Step>
Enter the copied contents of your private key into the **Private Key** field.
</Step>
<Step>
If your private key has a password, enter it in the **Private Key Password** field.
</Step>
<Step>
Select the correct **Private Key Type** from the drop down.
</Step>
<Step>
In the **Database** section, enter the name of the Snowflake database to connect to.
</Step>
<Step>
(Optional) Enter the schemas of the Snowflake database to connect to. If this is left blank, the connector has access to all schemas in the database.
</Step>
<SaveAndTest title="Snowflake"/>
<Step>
Snowflake で、Connect AI 静的IP アドレスを接続のホワイトリストに追加します。
</Step>
</Steps>
  </Tab>

  <Tab title="Okta">
<Steps>
<Step>
Enter the following information:
	- **User**— The Okta user account.
	- **Password**— The password associated with the Okta account.
	- **MFA Passcode**— Set this to the OTP code that was sent to your device. This property should be used only when Multi-Factor Authentication is required for Okta sign on.
	- **SSO Properties**— are needed to authenticate to Okta:
		- Domain: Set this to the OKTA org domain name.
		- MFAType (optional): Set this to the multi-factor type. This property should be used only when the MFA is required for Okta sign on. This property accepts one of the following values:
			- OKTAVerify
			- Email
			- SMS
		- APIToken (optional): Set this to the API Token created by Okta. This is used when authenticating a user via a trusted application or proxy that overrides the Okta client request context.
</Step>
<Step>
In the **Database** section, enter the name of the Snowflake database to connect to.
</Step>
<Step>
(Optional) Enter the schemas of the Snowflake database to connect to. If this is left blank, the connector has access to all schemas in the database.
</Step>
<SaveAndTest title="Snowflake"/>
<Step>
Snowflake で、Connect AI 静的IP アドレスを接続のホワイトリストに追加します。
</Step>
</Steps>
  </Tab>

  <Tab title="PingFederate">
<Steps>
<Step>
In the **User** field, enter 認証用のSnowflake ユーザー名.
</Step>
<Step>
In the **Password** field, enter ユーザーパスワード.
</Step>
<Step>
(Optional) Enter the **Proof Key**. You must specify this if you want to connect to PingFederate without using a browser.
</Step>
<Step>
(Optional) Enter the **External Token**. You must specify this if you want to connect to PingFederate without using a browser. For more information about the Proof Key and External Token, follow the steps [here](https://cdn.cdata.com/help/OWJ/cloud/default.htm#RSBSnowflake_p_AuthScheme).
</Step>
<Step>
(Optional) Enter the **Database** and **Schema**. Selecting a schema may improve performance for some applications.
</Step>
<SaveAndTest title="Snowflake"/>
</Steps>
  </Tab>
</Tabs>
## 詳細について

Connect AI とSnowflake の連携の詳細動作については、[こちらのページ](https://cdn.cdata.com/help/OWM/ja/cloud/default.htm#default)を参照してください。